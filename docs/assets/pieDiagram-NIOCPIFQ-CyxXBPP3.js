import{p as e}from"./chunk-353BL4L5-CbfpvhZL.js";import{a as t,g as a,s as i,b as n,c as s,q as r,p as o,l,d as p,E as c,I as d,L as m,e as g,y as h,G as u}from"./mermaid-core-CxzdCigi.js";import{p as f}from"./treemap-6Y5VK53G-zDneqk0b.js";import{w as x,x as S,y as w}from"./d3-charts-C9eKmPJg.js";import"./react-vendor-DQmNySUk.js";import"./_baseUniq-jCaBlI5l.js";import"./_basePickBy-BhhVUbw9.js";import"./clone-D_1IP6a6.js";var y=u.pie,$={sections:new Map,showData:!1},T=$.sections,D=$.showData,C=structuredClone(y),b={getConfig:t(()=>structuredClone(C),"getConfig"),clear:t(()=>{T=new Map,D=$.showData,h()},"clear"),setDiagramTitle:o,getDiagramTitle:r,setAccTitle:s,getAccTitle:n,setAccDescription:i,getAccDescription:a,addSection:t(({label:e,value:t})=>{T.has(e)||(T.set(e,t),l.debug(`added new section: ${e}, with value: ${t}`))},"addSection"),getSections:t(()=>T,"getSections"),setShowData:t(e=>{D=e},"setShowData"),getShowData:t(()=>D,"getShowData")},k=t((t,a)=>{e(t,a),a.setShowData(t.showData),t.sections.map(a.addSection)},"populateDb"),v={parse:t(async e=>{const t=await f("pie",e);l.debug(t),k(t,b)},"parse")},A=t(e=>`\n  .pieCircle{\n    stroke: ${e.pieStrokeColor};\n    stroke-width : ${e.pieStrokeWidth};\n    opacity : ${e.pieOpacity};\n  }\n  .pieOuterCircle{\n    stroke: ${e.pieOuterStrokeColor};\n    stroke-width: ${e.pieOuterStrokeWidth};\n    fill: none;\n  }\n  .pieTitleText {\n    text-anchor: middle;\n    font-size: ${e.pieTitleTextSize};\n    fill: ${e.pieTitleTextColor};\n    font-family: ${e.fontFamily};\n  }\n  .slice {\n    font-family: ${e.fontFamily};\n    fill: ${e.pieSectionTextColor};\n    font-size:${e.pieSectionTextSize};\n    // fill: white;\n  }\n  .legend text {\n    fill: ${e.pieLegendTextColor};\n    font-family: ${e.fontFamily};\n    font-size: ${e.pieLegendTextSize};\n  }\n`,"getStyles"),j=t(e=>{const t=[...e.entries()].map(e=>({label:e[0],value:e[1]})).sort((e,t)=>t.value-e.value);return w().value(e=>e.value)(t)},"createPieArcs"),z={parser:v,db:b,renderer:{draw:t((e,t,a,i)=>{l.debug("rendering pie chart\n"+e);const n=i.db,s=p(),r=c(n.getConfig(),s.pie),o=d(t),h=o.append("g");h.attr("transform","translate(225,225)");const{themeVariables:u}=s;let[f]=m(u.pieOuterStrokeWidth);f??=2;const w=r.textPosition,y=Math.min(450,450)/2-40,$=x().innerRadius(0).outerRadius(y),T=x().innerRadius(y*w).outerRadius(y*w);h.append("circle").attr("cx",0).attr("cy",0).attr("r",y+f/2).attr("class","pieOuterCircle");const D=n.getSections(),C=j(D),b=[u.pie1,u.pie2,u.pie3,u.pie4,u.pie5,u.pie6,u.pie7,u.pie8,u.pie9,u.pie10,u.pie11,u.pie12],k=S(b);h.selectAll("mySlices").data(C).enter().append("path").attr("d",$).attr("fill",e=>k(e.data.label)).attr("class","pieCircle");let v=0;D.forEach(e=>{v+=e}),h.selectAll("mySlices").data(C).enter().append("text").text(e=>(e.data.value/v*100).toFixed(0)+"%").attr("transform",e=>"translate("+T.centroid(e)+")").style("text-anchor","middle").attr("class","slice"),h.append("text").text(n.getDiagramTitle()).attr("x",0).attr("y",-200).attr("class","pieTitleText");const A=h.selectAll(".legend").data(k.domain()).enter().append("g").attr("class","legend").attr("transform",(e,t)=>"translate(216,"+(22*t-22*k.domain().length/2)+")");A.append("rect").attr("width",18).attr("height",18).style("fill",k).style("stroke",k),A.data(C).append("text").attr("x",22).attr("y",14).text(e=>{const{label:t,value:a}=e.data;return n.getShowData()?`${t} [${a}]`:t});const z=512+Math.max(...A.selectAll("text").nodes().map(e=>e?.getBoundingClientRect().width??0));o.attr("viewBox",`0 0 ${z} 450`),g(o,450,z,r.useMaxWidth)},"draw")},styles:A};export{z as diagram};
